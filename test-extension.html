<!DOCTYPE html>
<html>
<head>
    <title>Test MarkDownload Extension with ArXiv Math</title>
    <base href="https://arxiv.org/abs/1706.03762">
    <meta name="description" content="Test page for MarkDownload extension math processing">
</head>
<body>
    <h1>Attention Is All You Need</h1>
    
    <p>We propose a new simple network architecture, the Transformer, based solely on attention mechanisms, dispensing with recurrence and convolutions entirely. Experiments on two machine translation tasks show these models to be superior in quality while being more parallelizable and requiring significantly less time to train. Our model achieves 28.4 BLEU on the WMT 2014 English-to-German translation task, improving over the existing best results, including ensembles, by over 2 BLEU. On the WMT 2014 English-to-French translation task, our model establishes a new single-model state-of-the-art BLEU score of 41.8 after training for 3.5 days on eight GPUs, a small fraction of the training costs of the best models from the literature.</p>

    <p>The query, key and value matrices are computed as <math alttext="W^{Q}_{i}\in\mathbb{R}^{d_{\text{model}}\times d_{k}}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p4.1.m1.1"><semantics id="S3.SS2.SSS2.p4.1.m1.1a"><mrow id="S3.SS2.SSS2.p4.1.m1.1.1" xref="S3.SS2.SSS2.p4.1.m1.1.1.cmml"><msubsup id="S3.SS2.SSS2.p4.1.m1.1.1.2" xref="S3.SS2.SSS2.p4.1.m1.1.1.2.cmml"><mi id="S3.SS2.SSS2.p4.1.m1.1.1.2.2.2" xref="S3.SS2.SSS2.p4.1.m1.1.1.2.2.2.cmml">W</mi><mi id="S3.SS2.SSS2.p4.1.m1.1.1.2.3" xref="S3.SS2.SSS2.p4.1.m1.1.1.2.3.cmml">i</mi><mi id="S3.SS2.SSS2.p4.1.m1.1.1.2.2.3" xref="S3.SS2.SSS2.p4.1.m1.1.1.2.2.3.cmml">Q</mi></msubsup><mo id="S3.SS2.SSS2.p4.1.m1.1.1.1" xref="S3.SS2.SSS2.p4.1.m1.1.1.1.cmml">‚àà</mo><msup id="S3.SS2.SSS2.p4.1.m1.1.1.3" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS2.p4.1.m1.1.1.3.2" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.2.cmml">‚Ñù</mi><mrow id="S3.SS2.SSS2.p4.1.m1.1.1.3.3" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.cmml"><msub id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.cmml"><mi id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.2" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.2.cmml">d</mi><mtext id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.3" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.3a.cmml">model</mtext></msub><mo id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.1.cmml">√ó</mo><msub id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3.2" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3.3" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.1.m1.1b"><apply id="S3.SS2.SSS2.p4.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1"><in id="S3.SS2.SSS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.1"></in><apply id="S3.SS2.SSS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.2">subscript</csymbol><apply id="S3.SS2.SSS2.p4.1.m1.1.1.2.2.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.1.m1.1.1.2.2.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS2.p4.1.m1.1.1.2.2.2.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.2.2.2">ùëä</ci><ci id="S3.SS2.SSS2.p4.1.m1.1.1.2.2.3.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.2.2.3">ùëÑ</ci></apply><ci id="S3.SS2.SSS2.p4.1.m1.1.1.2.3.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.2.3">ùëñ</ci></apply><apply id="S3.SS2.SSS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS2.p4.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.2">‚Ñù</ci><apply id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3"><times id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.1"></times><apply id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.2.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.2">ùëë</ci><ci id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.3a.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.3"><mtext id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.3.cmml" mathsize="50%" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.3">model</mtext></ci></apply><apply id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3.2">ùëë</ci><ci id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3.3">ùëò</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.1.m1.1c">W^{Q}_{i}\in\mathbb{R}^{d_{\text{model}}\times d_{k}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p4.1.m1.1d">italic_W start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ‚àà blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT √ó italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> where the dimensions are defined appropriately.</p>

    <h2>Multi-Head Attention</h2>
    
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx1">
        <tbody id="S3.Ex1">
            <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
                <td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
                <td class="ltx_td ltx_align_right ltx_eqn_cell">
                    <math alttext="\displaystyle\mathrm{MultiHead}(Q,K,V)" class="ltx_Math" display="inline" id="S3.Ex1.m1.3">
                        <semantics id="S3.Ex1.m1.3a">
                            <mrow id="S3.Ex1.m1.3.4" xref="S3.Ex1.m1.3.4.cmml">
                                <mi id="S3.Ex1.m1.3.4.2" xref="S3.Ex1.m1.3.4.2.cmml">MultiHead</mi>
                                <mo id="S3.Ex1.m1.3.4.1" xref="S3.Ex1.m1.3.4.1.cmml">‚Å¢</mo>
                                <mrow id="S3.Ex1.m1.3.4.3.2" xref="S3.Ex1.m1.3.4.3.1.cmml">
                                    <mo id="S3.Ex1.m1.3.4.3.2.1" stretchy="false" xref="S3.Ex1.m1.3.4.3.1.cmml">(</mo>
                                    <mi id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml">Q</mi>
                                    <mo id="S3.Ex1.m1.3.4.3.2.2" xref="S3.Ex1.m1.3.4.3.1.cmml">,</mo>
                                    <mi id="S3.Ex1.m1.2.2" xref="S3.Ex1.m1.2.2.cmml">K</mi>
                                    <mo id="S3.Ex1.m1.3.4.3.2.3" xref="S3.Ex1.m1.3.4.3.1.cmml">,</mo>
                                    <mi id="S3.Ex1.m1.3.3" xref="S3.Ex1.m1.3.3.cmml">V</mi>
                                    <mo id="S3.Ex1.m1.3.4.3.2.4" stretchy="false" xref="S3.Ex1.m1.3.4.3.1.cmml">)</mo>
                                </mrow>
                            </mrow>
                            <annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.3b">
                                <apply id="S3.Ex1.m1.3.4.cmml" xref="S3.Ex1.m1.3.4">
                                    <times id="S3.Ex1.m1.3.4.1.cmml" xref="S3.Ex1.m1.3.4.1"></times>
                                    <ci id="S3.Ex1.m1.3.4.2.cmml" xref="S3.Ex1.m1.3.4.2">MultiHead</ci>
                                    <vector id="S3.Ex1.m1.3.4.3.1.cmml" xref="S3.Ex1.m1.3.4.3.2">
                                        <ci id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1">ùëÑ</ci>
                                        <ci id="S3.Ex1.m1.2.2.cmml" xref="S3.Ex1.m1.2.2">ùêæ</ci>
                                        <ci id="S3.Ex1.m1.3.3.cmml" xref="S3.Ex1.m1.3.3">ùëâ</ci>
                                    </vector>
                                </apply>
                            </annotation-xml>
                            <annotation encoding="application/x-tex" id="S3.Ex1.m1.3c">\displaystyle\mathrm{MultiHead}(Q,K,V)</annotation>
                            <annotation encoding="application/x-llamapun" id="S3.Ex1.m1.3d">roman_MultiHead ( italic_Q , italic_K , italic_V )</annotation>
                        </semantics>
                    </math>
                </td>
                <td class="ltx_td ltx_align_left ltx_eqn_cell">
                    <math alttext="\displaystyle=\mathrm{Concat}(\mathrm{head_{1}},...,\mathrm{head_{h}})W^{O}" class="ltx_Math" display="inline" id="S3.Ex1.m2.3">
                        <semantics id="S3.Ex1.m2.3a">
                            <mrow id="S3.Ex1.m2.3.3" xref="S3.Ex1.m2.3.3.cmml">
                                <mi id="S3.Ex1.m2.3.3.4" xref="S3.Ex1.m2.3.3.4.cmml"></mi>
                                <mo id="S3.Ex1.m2.3.3.3" xref="S3.Ex1.m2.3.3.3.cmml">=</mo>
                                <mrow id="S3.Ex1.m2.3.3.2" xref="S3.Ex1.m2.3.3.2.cmml">
                                    <mi id="S3.Ex1.m2.3.3.2.4" xref="S3.Ex1.m2.3.3.2.4.cmml">Concat</mi>
                                    <mo id="S3.Ex1.m2.3.3.2.3" xref="S3.Ex1.m2.3.3.2.3.cmml">‚Å¢</mo>
                                    <mrow id="S3.Ex1.m2.3.3.2.2.2" xref="S3.Ex1.m2.3.3.2.2.3.cmml">
                                        <mo id="S3.Ex1.m2.3.3.2.2.2.3" stretchy="false" xref="S3.Ex1.m2.3.3.2.2.3.cmml">(</mo>
                                        <msub id="S3.Ex1.m2.2.2.1.1.1.1" xref="S3.Ex1.m2.2.2.1.1.1.1.cmml">
                                            <mi id="S3.Ex1.m2.2.2.1.1.1.1.2" xref="S3.Ex1.m2.2.2.1.1.1.1.2.cmml">head</mi>
                                            <mn id="S3.Ex1.m2.2.2.1.1.1.1.3" xref="S3.Ex1.m2.2.2.1.1.1.1.3.cmml">1</mn>
                                        </msub>
                                        <mo id="S3.Ex1.m2.3.3.2.2.2.4" xref="S3.Ex1.m2.3.3.2.2.3.cmml">,</mo>
                                        <mi id="S3.Ex1.m2.1.1" mathvariant="normal" xref="S3.Ex1.m2.1.1.cmml">‚Ä¶</mi>
                                        <mo id="S3.Ex1.m2.3.3.2.2.2.5" xref="S3.Ex1.m2.3.3.2.2.3.cmml">,</mo>
                                        <msub id="S3.Ex1.m2.3.3.2.2.2.2" xref="S3.Ex1.m2.3.3.2.2.2.2.cmml">
                                            <mi id="S3.Ex1.m2.3.3.2.2.2.2.2" xref="S3.Ex1.m2.3.3.2.2.2.2.2.cmml">head</mi>
                                            <mi id="S3.Ex1.m2.3.3.2.2.2.2.3" mathvariant="normal" xref="S3.Ex1.m2.3.3.2.2.2.2.3.cmml">h</mi>
                                        </msub>
                                        <mo id="S3.Ex1.m2.3.3.2.2.2.6" stretchy="false" xref="S3.Ex1.m2.3.3.2.2.3.cmml">)</mo>
                                    </mrow>
                                    <mo id="S3.Ex1.m2.3.3.2.3a" xref="S3.Ex1.m2.3.3.2.3.cmml">‚Å¢</mo>
                                    <msup id="S3.Ex1.m2.3.3.2.5" xref="S3.Ex1.m2.3.3.2.5.cmml">
                                        <mi id="S3.Ex1.m2.3.3.2.5.2" xref="S3.Ex1.m2.3.3.2.5.2.cmml">W</mi>
                                        <mi id="S3.Ex1.m2.3.3.2.5.3" xref="S3.Ex1.m2.3.3.2.5.3.cmml">O</mi>
                                    </msup>
                                </mrow>
                            </mrow>
                            <annotation-xml encoding="MathML-Content" id="S3.Ex1.m2.3b">
                                <!-- ÁúÅÁï•Â§ßÈáèMathML-Content -->
                            </annotation-xml>
                            <annotation encoding="application/x-tex" id="S3.Ex1.m2.3c">\displaystyle=\mathrm{Concat}(\mathrm{head_{1}},...,\mathrm{head_{h}})W^{O}</annotation>
                            <annotation encoding="application/x-llamapun" id="S3.Ex1.m2.3d">= roman_Concat ( roman_head start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , ‚Ä¶ , roman_head start_POSTSUBSCRIPT roman_h end_POSTSUBSCRIPT ) italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT</annotation>
                        </semantics>
                    </math>
                </td>
                <td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
            </tr>
        </tbody>
    </table>

    <p>This completes the definition of multi-head attention mechanism.</p>

    <div style="margin-top: 50px; padding: 20px; background-color: #f0f0f0; border: 1px solid #ccc;">
        <h3>Debug Test Instructions</h3>
        <p>This page contains actual MathML content from debug.html, with detailed debug information added. Please:</p>
        <ol>
            <li>Load MarkDownload extension in Chrome browser (Developer mode, load src folder)</li>
            <li><strong>Open browser Developer Tools Console panel</strong></li>
            <li>Click the extension icon on this page</li>
            <li><strong>Check debug information in Console to understand the processing flow</strong></li>
            <li>Check if the generated Markdown correctly processes math formulas</li>
        </ol>
        <p><strong>Debug information includes:</strong></p>
        <ul>
            <li><code>[MarkDownload Debug] contentScript:</code> - Content script stage information</li>
            <li><code>[MarkDownload Debug] background:</code> - Background script stage information</li>
            <li><code>[MarkDownload Debug] offscreen:</code> - Offscreen processing stage information</li>
        </ul>
        <p><strong>Expected results:</strong></p>
        <ul>
            <li>Inline formula should display as: <code>$W^{Q}_{i}\in\mathbb{R}^{d_{\text{model}}\times d_{k}}$</code></li>
            <li>Table formulas should display as clean LaTeX format, not lots of HTML markup</li>
        </ul>
        <p><strong>If there are issues, check the debug information in Console to find out which stage has problems.</strong></p>
    </div>
</body>
</html>