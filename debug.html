<math alttext="W^{Q}_{i}\in\mathbb{R}^{d_{\text{model}}\times d_{k}}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p4.1.m1.1"><semantics id="S3.SS2.SSS2.p4.1.m1.1a"><mrow id="S3.SS2.SSS2.p4.1.m1.1.1" xref="S3.SS2.SSS2.p4.1.m1.1.1.cmml"><msubsup id="S3.SS2.SSS2.p4.1.m1.1.1.2" xref="S3.SS2.SSS2.p4.1.m1.1.1.2.cmml"><mi id="S3.SS2.SSS2.p4.1.m1.1.1.2.2.2" xref="S3.SS2.SSS2.p4.1.m1.1.1.2.2.2.cmml">W</mi><mi id="S3.SS2.SSS2.p4.1.m1.1.1.2.3" xref="S3.SS2.SSS2.p4.1.m1.1.1.2.3.cmml">i</mi><mi id="S3.SS2.SSS2.p4.1.m1.1.1.2.2.3" xref="S3.SS2.SSS2.p4.1.m1.1.1.2.2.3.cmml">Q</mi></msubsup><mo id="S3.SS2.SSS2.p4.1.m1.1.1.1" xref="S3.SS2.SSS2.p4.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS2.p4.1.m1.1.1.3" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS2.p4.1.m1.1.1.3.2" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS2.p4.1.m1.1.1.3.3" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.cmml"><msub id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.cmml"><mi id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.2" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.2.cmml">d</mi><mtext id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.3" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.3a.cmml">model</mtext></msub><mo id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3.2" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3.3" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3.3.cmml">k</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.1.m1.1b"><apply id="S3.SS2.SSS2.p4.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1"><in id="S3.SS2.SSS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.1"></in><apply id="S3.SS2.SSS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.2">subscript</csymbol><apply id="S3.SS2.SSS2.p4.1.m1.1.1.2.2.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.1.m1.1.1.2.2.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS2.p4.1.m1.1.1.2.2.2.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.2.2.2">𝑊</ci><ci id="S3.SS2.SSS2.p4.1.m1.1.1.2.2.3.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.2.2.3">𝑄</ci></apply><ci id="S3.SS2.SSS2.p4.1.m1.1.1.2.3.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.SSS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS2.p4.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3"><times id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.1"></times><apply id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.2.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.2">𝑑</ci><ci id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.3a.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.3"><mtext id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.3.cmml" mathsize="50%" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.2.3">model</mtext></ci></apply><apply id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.1.m1.1c">W^{Q}_{i}\in\mathbb{R}^{d_{\text{model}}\times d_{k}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p4.1.m1.1d">italic_W start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT model end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>


<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="Sx1.EGx1">
<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathrm{MultiHead}(Q,K,V)" class="ltx_Math" display="inline" id="S3.Ex1.m1.3"><semantics id="S3.Ex1.m1.3a"><mrow id="S3.Ex1.m1.3.4" xref="S3.Ex1.m1.3.4.cmml"><mi id="S3.Ex1.m1.3.4.2" xref="S3.Ex1.m1.3.4.2.cmml">MultiHead</mi><mo id="S3.Ex1.m1.3.4.1" xref="S3.Ex1.m1.3.4.1.cmml">⁢</mo><mrow id="S3.Ex1.m1.3.4.3.2" xref="S3.Ex1.m1.3.4.3.1.cmml"><mo id="S3.Ex1.m1.3.4.3.2.1" stretchy="false" xref="S3.Ex1.m1.3.4.3.1.cmml">(</mo><mi id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml">Q</mi><mo id="S3.Ex1.m1.3.4.3.2.2" xref="S3.Ex1.m1.3.4.3.1.cmml">,</mo><mi id="S3.Ex1.m1.2.2" xref="S3.Ex1.m1.2.2.cmml">K</mi><mo id="S3.Ex1.m1.3.4.3.2.3" xref="S3.Ex1.m1.3.4.3.1.cmml">,</mo><mi id="S3.Ex1.m1.3.3" xref="S3.Ex1.m1.3.3.cmml">V</mi><mo id="S3.Ex1.m1.3.4.3.2.4" stretchy="false" xref="S3.Ex1.m1.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.3b"><apply id="S3.Ex1.m1.3.4.cmml" xref="S3.Ex1.m1.3.4"><times id="S3.Ex1.m1.3.4.1.cmml" xref="S3.Ex1.m1.3.4.1"></times><ci id="S3.Ex1.m1.3.4.2.cmml" xref="S3.Ex1.m1.3.4.2">MultiHead</ci><vector id="S3.Ex1.m1.3.4.3.1.cmml" xref="S3.Ex1.m1.3.4.3.2"><ci id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1">𝑄</ci><ci id="S3.Ex1.m1.2.2.cmml" xref="S3.Ex1.m1.2.2">𝐾</ci><ci id="S3.Ex1.m1.3.3.cmml" xref="S3.Ex1.m1.3.3">𝑉</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.3c">\displaystyle\mathrm{MultiHead}(Q,K,V)</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.3d">roman_MultiHead ( italic_Q , italic_K , italic_V )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathrm{Concat}(\mathrm{head_{1}},...,\mathrm{head_{h}})W^{O}" class="ltx_Math" display="inline" id="S3.Ex1.m2.3"><semantics id="S3.Ex1.m2.3a"><mrow id="S3.Ex1.m2.3.3" xref="S3.Ex1.m2.3.3.cmml"><mi id="S3.Ex1.m2.3.3.4" xref="S3.Ex1.m2.3.3.4.cmml"></mi><mo id="S3.Ex1.m2.3.3.3" xref="S3.Ex1.m2.3.3.3.cmml">=</mo><mrow id="S3.Ex1.m2.3.3.2" xref="S3.Ex1.m2.3.3.2.cmml"><mi id="S3.Ex1.m2.3.3.2.4" xref="S3.Ex1.m2.3.3.2.4.cmml">Concat</mi><mo id="S3.Ex1.m2.3.3.2.3" xref="S3.Ex1.m2.3.3.2.3.cmml">⁢</mo><mrow id="S3.Ex1.m2.3.3.2.2.2" xref="S3.Ex1.m2.3.3.2.2.3.cmml"><mo id="S3.Ex1.m2.3.3.2.2.2.3" stretchy="false" xref="S3.Ex1.m2.3.3.2.2.3.cmml">(</mo><msub id="S3.Ex1.m2.2.2.1.1.1.1" xref="S3.Ex1.m2.2.2.1.1.1.1.cmml"><mi id="S3.Ex1.m2.2.2.1.1.1.1.2" xref="S3.Ex1.m2.2.2.1.1.1.1.2.cmml">head</mi><mn id="S3.Ex1.m2.2.2.1.1.1.1.3" xref="S3.Ex1.m2.2.2.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.Ex1.m2.3.3.2.2.2.4" xref="S3.Ex1.m2.3.3.2.2.3.cmml">,</mo><mi id="S3.Ex1.m2.1.1" mathvariant="normal" xref="S3.Ex1.m2.1.1.cmml">…</mi><mo id="S3.Ex1.m2.3.3.2.2.2.5" xref="S3.Ex1.m2.3.3.2.2.3.cmml">,</mo><msub id="S3.Ex1.m2.3.3.2.2.2.2" xref="S3.Ex1.m2.3.3.2.2.2.2.cmml"><mi id="S3.Ex1.m2.3.3.2.2.2.2.2" xref="S3.Ex1.m2.3.3.2.2.2.2.2.cmml">head</mi><mi id="S3.Ex1.m2.3.3.2.2.2.2.3" mathvariant="normal" xref="S3.Ex1.m2.3.3.2.2.2.2.3.cmml">h</mi></msub><mo id="S3.Ex1.m2.3.3.2.2.2.6" stretchy="false" xref="S3.Ex1.m2.3.3.2.2.3.cmml">)</mo></mrow><mo id="S3.Ex1.m2.3.3.2.3a" xref="S3.Ex1.m2.3.3.2.3.cmml">⁢</mo><msup id="S3.Ex1.m2.3.3.2.5" xref="S3.Ex1.m2.3.3.2.5.cmml"><mi id="S3.Ex1.m2.3.3.2.5.2" xref="S3.Ex1.m2.3.3.2.5.2.cmml">W</mi><mi id="S3.Ex1.m2.3.3.2.5.3" xref="S3.Ex1.m2.3.3.2.5.3.cmml">O</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m2.3b"><apply id="S3.Ex1.m2.3.3.cmml" xref="S3.Ex1.m2.3.3"><eq id="S3.Ex1.m2.3.3.3.cmml" xref="S3.Ex1.m2.3.3.3"></eq><csymbol cd="latexml" id="S3.Ex1.m2.3.3.4.cmml" xref="S3.Ex1.m2.3.3.4">absent</csymbol><apply id="S3.Ex1.m2.3.3.2.cmml" xref="S3.Ex1.m2.3.3.2"><times id="S3.Ex1.m2.3.3.2.3.cmml" xref="S3.Ex1.m2.3.3.2.3"></times><ci id="S3.Ex1.m2.3.3.2.4.cmml" xref="S3.Ex1.m2.3.3.2.4">Concat</ci><vector id="S3.Ex1.m2.3.3.2.2.3.cmml" xref="S3.Ex1.m2.3.3.2.2.2"><apply id="S3.Ex1.m2.2.2.1.1.1.1.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m2.2.2.1.1.1.1.1.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m2.2.2.1.1.1.1.2.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.2">head</ci><cn id="S3.Ex1.m2.2.2.1.1.1.1.3.cmml" type="integer" xref="S3.Ex1.m2.2.2.1.1.1.1.3">1</cn></apply><ci id="S3.Ex1.m2.1.1.cmml" xref="S3.Ex1.m2.1.1">…</ci><apply id="S3.Ex1.m2.3.3.2.2.2.2.cmml" xref="S3.Ex1.m2.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.3.3.2.2.2.2.1.cmml" xref="S3.Ex1.m2.3.3.2.2.2.2">subscript</csymbol><ci id="S3.Ex1.m2.3.3.2.2.2.2.2.cmml" xref="S3.Ex1.m2.3.3.2.2.2.2.2">head</ci><ci id="S3.Ex1.m2.3.3.2.2.2.2.3.cmml" xref="S3.Ex1.m2.3.3.2.2.2.2.3">h</ci></apply></vector><apply id="S3.Ex1.m2.3.3.2.5.cmml" xref="S3.Ex1.m2.3.3.2.5"><csymbol cd="ambiguous" id="S3.Ex1.m2.3.3.2.5.1.cmml" xref="S3.Ex1.m2.3.3.2.5">superscript</csymbol><ci id="S3.Ex1.m2.3.3.2.5.2.cmml" xref="S3.Ex1.m2.3.3.2.5.2">𝑊</ci><ci id="S3.Ex1.m2.3.3.2.5.3.cmml" xref="S3.Ex1.m2.3.3.2.5.3">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m2.3c">\displaystyle=\mathrm{Concat}(\mathrm{head_{1}},...,\mathrm{head_{h}})W^{O}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m2.3d">= roman_Concat ( roman_head start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , roman_head start_POSTSUBSCRIPT roman_h end_POSTSUBSCRIPT ) italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{where}~{}\mathrm{head_{i}}" class="ltx_Math" display="inline" id="S3.Ex2.m1.1"><semantics id="S3.Ex2.m1.1a"><mrow id="S3.Ex2.m1.1.1" xref="S3.Ex2.m1.1.1.cmml"><mtext id="S3.Ex2.m1.1.1.2" xref="S3.Ex2.m1.1.1.2a.cmml">where</mtext><mo id="S3.Ex2.m1.1.1.1" lspace="0.330em" xref="S3.Ex2.m1.1.1.1.cmml">⁢</mo><msub id="S3.Ex2.m1.1.1.3" xref="S3.Ex2.m1.1.1.3.cmml"><mi id="S3.Ex2.m1.1.1.3.2" xref="S3.Ex2.m1.1.1.3.2.cmml">head</mi><mi id="S3.Ex2.m1.1.1.3.3" mathvariant="normal" xref="S3.Ex2.m1.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.1b"><apply id="S3.Ex2.m1.1.1.cmml" xref="S3.Ex2.m1.1.1"><times id="S3.Ex2.m1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1"></times><ci id="S3.Ex2.m1.1.1.2a.cmml" xref="S3.Ex2.m1.1.1.2"><mtext id="S3.Ex2.m1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.2">where</mtext></ci><apply id="S3.Ex2.m1.1.1.3.cmml" xref="S3.Ex2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.3.1.cmml" xref="S3.Ex2.m1.1.1.3">subscript</csymbol><ci id="S3.Ex2.m1.1.1.3.2.cmml" xref="S3.Ex2.m1.1.1.3.2">head</ci><ci id="S3.Ex2.m1.1.1.3.3.cmml" xref="S3.Ex2.m1.1.1.3.3">i</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.1c">\displaystyle\text{where}~{}\mathrm{head_{i}}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2.m1.1d">where roman_head start_POSTSUBSCRIPT roman_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathrm{Attention}(QW^{Q}_{i},KW^{K}_{i},VW^{V}_{i})" class="ltx_Math" display="inline" id="S3.Ex2.m2.3"><semantics id="S3.Ex2.m2.3a"><mrow id="S3.Ex2.m2.3.3" xref="S3.Ex2.m2.3.3.cmml"><mi id="S3.Ex2.m2.3.3.5" xref="S3.Ex2.m2.3.3.5.cmml"></mi><mo id="S3.Ex2.m2.3.3.4" xref="S3.Ex2.m2.3.3.4.cmml">=</mo><mrow id="S3.Ex2.m2.3.3.3" xref="S3.Ex2.m2.3.3.3.cmml"><mi id="S3.Ex2.m2.3.3.3.5" xref="S3.Ex2.m2.3.3.3.5.cmml">Attention</mi><mo id="S3.Ex2.m2.3.3.3.4" xref="S3.Ex2.m2.3.3.3.4.cmml">⁢</mo><mrow id="S3.Ex2.m2.3.3.3.3.3" xref="S3.Ex2.m2.3.3.3.3.4.cmml"><mo id="S3.Ex2.m2.3.3.3.3.3.4" stretchy="false" xref="S3.Ex2.m2.3.3.3.3.4.cmml">(</mo><mrow id="S3.Ex2.m2.1.1.1.1.1.1" xref="S3.Ex2.m2.1.1.1.1.1.1.cmml"><mi id="S3.Ex2.m2.1.1.1.1.1.1.2" xref="S3.Ex2.m2.1.1.1.1.1.1.2.cmml">Q</mi><mo id="S3.Ex2.m2.1.1.1.1.1.1.1" xref="S3.Ex2.m2.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="S3.Ex2.m2.1.1.1.1.1.1.3" xref="S3.Ex2.m2.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex2.m2.1.1.1.1.1.1.3.2.2" xref="S3.Ex2.m2.1.1.1.1.1.1.3.2.2.cmml">W</mi><mi id="S3.Ex2.m2.1.1.1.1.1.1.3.3" xref="S3.Ex2.m2.1.1.1.1.1.1.3.3.cmml">i</mi><mi id="S3.Ex2.m2.1.1.1.1.1.1.3.2.3" xref="S3.Ex2.m2.1.1.1.1.1.1.3.2.3.cmml">Q</mi></msubsup></mrow><mo id="S3.Ex2.m2.3.3.3.3.3.5" xref="S3.Ex2.m2.3.3.3.3.4.cmml">,</mo><mrow id="S3.Ex2.m2.2.2.2.2.2.2" xref="S3.Ex2.m2.2.2.2.2.2.2.cmml"><mi id="S3.Ex2.m2.2.2.2.2.2.2.2" xref="S3.Ex2.m2.2.2.2.2.2.2.2.cmml">K</mi><mo id="S3.Ex2.m2.2.2.2.2.2.2.1" xref="S3.Ex2.m2.2.2.2.2.2.2.1.cmml">⁢</mo><msubsup id="S3.Ex2.m2.2.2.2.2.2.2.3" xref="S3.Ex2.m2.2.2.2.2.2.2.3.cmml"><mi id="S3.Ex2.m2.2.2.2.2.2.2.3.2.2" xref="S3.Ex2.m2.2.2.2.2.2.2.3.2.2.cmml">W</mi><mi id="S3.Ex2.m2.2.2.2.2.2.2.3.3" xref="S3.Ex2.m2.2.2.2.2.2.2.3.3.cmml">i</mi><mi id="S3.Ex2.m2.2.2.2.2.2.2.3.2.3" xref="S3.Ex2.m2.2.2.2.2.2.2.3.2.3.cmml">K</mi></msubsup></mrow><mo id="S3.Ex2.m2.3.3.3.3.3.6" xref="S3.Ex2.m2.3.3.3.3.4.cmml">,</mo><mrow id="S3.Ex2.m2.3.3.3.3.3.3" xref="S3.Ex2.m2.3.3.3.3.3.3.cmml"><mi id="S3.Ex2.m2.3.3.3.3.3.3.2" xref="S3.Ex2.m2.3.3.3.3.3.3.2.cmml">V</mi><mo id="S3.Ex2.m2.3.3.3.3.3.3.1" xref="S3.Ex2.m2.3.3.3.3.3.3.1.cmml">⁢</mo><msubsup id="S3.Ex2.m2.3.3.3.3.3.3.3" xref="S3.Ex2.m2.3.3.3.3.3.3.3.cmml"><mi id="S3.Ex2.m2.3.3.3.3.3.3.3.2.2" xref="S3.Ex2.m2.3.3.3.3.3.3.3.2.2.cmml">W</mi><mi id="S3.Ex2.m2.3.3.3.3.3.3.3.3" xref="S3.Ex2.m2.3.3.3.3.3.3.3.3.cmml">i</mi><mi id="S3.Ex2.m2.3.3.3.3.3.3.3.2.3" xref="S3.Ex2.m2.3.3.3.3.3.3.3.2.3.cmml">V</mi></msubsup></mrow><mo id="S3.Ex2.m2.3.3.3.3.3.7" stretchy="false" xref="S3.Ex2.m2.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m2.3b"><apply id="S3.Ex2.m2.3.3.cmml" xref="S3.Ex2.m2.3.3"><eq id="S3.Ex2.m2.3.3.4.cmml" xref="S3.Ex2.m2.3.3.4"></eq><csymbol cd="latexml" id="S3.Ex2.m2.3.3.5.cmml" xref="S3.Ex2.m2.3.3.5">absent</csymbol><apply id="S3.Ex2.m2.3.3.3.cmml" xref="S3.Ex2.m2.3.3.3"><times id="S3.Ex2.m2.3.3.3.4.cmml" xref="S3.Ex2.m2.3.3.3.4"></times><ci id="S3.Ex2.m2.3.3.3.5.cmml" xref="S3.Ex2.m2.3.3.3.5">Attention</ci><vector id="S3.Ex2.m2.3.3.3.3.4.cmml" xref="S3.Ex2.m2.3.3.3.3.3"><apply id="S3.Ex2.m2.1.1.1.1.1.1.cmml" xref="S3.Ex2.m2.1.1.1.1.1.1"><times id="S3.Ex2.m2.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m2.1.1.1.1.1.1.1"></times><ci id="S3.Ex2.m2.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m2.1.1.1.1.1.1.2">𝑄</ci><apply id="S3.Ex2.m2.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m2.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex2.m2.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.Ex2.m2.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex2.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m2.1.1.1.1.1.1.3.2.1.cmml" xref="S3.Ex2.m2.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.Ex2.m2.1.1.1.1.1.1.3.2.2.cmml" xref="S3.Ex2.m2.1.1.1.1.1.1.3.2.2">𝑊</ci><ci id="S3.Ex2.m2.1.1.1.1.1.1.3.2.3.cmml" xref="S3.Ex2.m2.1.1.1.1.1.1.3.2.3">𝑄</ci></apply><ci id="S3.Ex2.m2.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex2.m2.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.Ex2.m2.2.2.2.2.2.2.cmml" xref="S3.Ex2.m2.2.2.2.2.2.2"><times id="S3.Ex2.m2.2.2.2.2.2.2.1.cmml" xref="S3.Ex2.m2.2.2.2.2.2.2.1"></times><ci id="S3.Ex2.m2.2.2.2.2.2.2.2.cmml" xref="S3.Ex2.m2.2.2.2.2.2.2.2">𝐾</ci><apply id="S3.Ex2.m2.2.2.2.2.2.2.3.cmml" xref="S3.Ex2.m2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex2.m2.2.2.2.2.2.2.3.1.cmml" xref="S3.Ex2.m2.2.2.2.2.2.2.3">subscript</csymbol><apply id="S3.Ex2.m2.2.2.2.2.2.2.3.2.cmml" xref="S3.Ex2.m2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex2.m2.2.2.2.2.2.2.3.2.1.cmml" xref="S3.Ex2.m2.2.2.2.2.2.2.3">superscript</csymbol><ci id="S3.Ex2.m2.2.2.2.2.2.2.3.2.2.cmml" xref="S3.Ex2.m2.2.2.2.2.2.2.3.2.2">𝑊</ci><ci id="S3.Ex2.m2.2.2.2.2.2.2.3.2.3.cmml" xref="S3.Ex2.m2.2.2.2.2.2.2.3.2.3">𝐾</ci></apply><ci id="S3.Ex2.m2.2.2.2.2.2.2.3.3.cmml" xref="S3.Ex2.m2.2.2.2.2.2.2.3.3">𝑖</ci></apply></apply><apply id="S3.Ex2.m2.3.3.3.3.3.3.cmml" xref="S3.Ex2.m2.3.3.3.3.3.3"><times id="S3.Ex2.m2.3.3.3.3.3.3.1.cmml" xref="S3.Ex2.m2.3.3.3.3.3.3.1"></times><ci id="S3.Ex2.m2.3.3.3.3.3.3.2.cmml" xref="S3.Ex2.m2.3.3.3.3.3.3.2">𝑉</ci><apply id="S3.Ex2.m2.3.3.3.3.3.3.3.cmml" xref="S3.Ex2.m2.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.Ex2.m2.3.3.3.3.3.3.3.1.cmml" xref="S3.Ex2.m2.3.3.3.3.3.3.3">subscript</csymbol><apply id="S3.Ex2.m2.3.3.3.3.3.3.3.2.cmml" xref="S3.Ex2.m2.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.Ex2.m2.3.3.3.3.3.3.3.2.1.cmml" xref="S3.Ex2.m2.3.3.3.3.3.3.3">superscript</csymbol><ci id="S3.Ex2.m2.3.3.3.3.3.3.3.2.2.cmml" xref="S3.Ex2.m2.3.3.3.3.3.3.3.2.2">𝑊</ci><ci id="S3.Ex2.m2.3.3.3.3.3.3.3.2.3.cmml" xref="S3.Ex2.m2.3.3.3.3.3.3.3.2.3">𝑉</ci></apply><ci id="S3.Ex2.m2.3.3.3.3.3.3.3.3.cmml" xref="S3.Ex2.m2.3.3.3.3.3.3.3.3">𝑖</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m2.3c">\displaystyle=\mathrm{Attention}(QW^{Q}_{i},KW^{K}_{i},VW^{V}_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2.m2.3d">= roman_Attention ( italic_Q italic_W start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_K italic_W start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_V italic_W start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>

